{% extends "base.html" %} 
{% load sao_tags %}

{% block content%}

<script>

function submit()
{
	var yearmonth = document.getElementById("id_yearmonth").value
	var filter_diactive = document.getElementById("id_filter_deactive").checked
    var form = document.getElementById("yearmonthform");

	var url = "{% url 'sao:overview' %}"
	if(filter_diactive)
	{
		url = url + "\?f_deactive&"
	}
	else{
		url = url + "\?"
	}
	url = url + "yearmonth="+yearmonth
	location.href = url
    //form.submit();

}

</script>

<div class="container">
	<div class="page-header">勤務実績一覧 {{summaries|length}}件
	</div>

	{% if not summaries %}
		<div class="alert alert-danger">
			勤怠データが存在しません
		</div>
	{% endif %}

	<div>
		<div class="pull-left">
		{{ form }}
		</div>
		<div class="checkbox col-xs-4">
			<label><input id='id_filter_deactive' type="checkbox" name="filter" onchange=submit() {{checked}}>在籍スタッフ以外非表示</label>
		</div>					
	</div>
		
	<br>
	<table class="table table-striped table-bordered table-hover">
		<tr>
			<th>種別</th>
			<th>所属</th>
			<th>No</th>
			<th>氏名</th>
			{% if user.is_staff or user.permission.enable_view_temporary_staff_record %}
			<th>所定勤務日数</th>
			<th>出勤日数</th>
			<th>有休取得日数</th>
			<th>代休日数</th>
			<th>欠勤日数</th>
			<th>特別休暇日数</th>
			<th>遅刻回数</th>
			<th>早退回数</th>
			<th>休日出勤日数</th>
			<th>有休残数</th>
			{% endif %}
			<th>時間外</th>
			{% if user.is_staff or user.permission.enable_view_temporary_staff_record %}
			<th>詳細</th>
			<th>WEB打刻</th>
			{% endif %}
		</tr>
		{% for o in summaries %}
		{% if o.employee.user.is_active %}
		<tr>
		{% else %}
		<tr class="warning">
		{% endif %}
			<td>{{o.type}}</td>
			<td>{{o.department}}</td>
			<td>{{o.employee.employee_no}}</td>
			<td>{{o.employee.name}}</td>
			{% if user.is_staff or user.permission.enable_view_temporary_staff_record %}
			<td class="text-right">{{o.daycount.0}}</td>
			<td class="text-right">{{o.daycount.1}}</td>
			<td class="text-right">{{o.daycount.2}}</td>
			<td class="text-right">{{o.daycount.3}}</td>
			<td class="text-right">{{o.daycount.4}}</td>
			<td class="text-right">{{o.daycount.5}}</td>
			<td class="text-right">{{o.daycount.6}}</td>
			<td class="text-right">{{o.daycount.7}}</td>
			<td class="text-right">{{o.daycount.8}}</td>
			<td class="text-right">{{o.daycount.9}}</td>
			{% endif %}
			<td class="text-right">{{o.overtime_work|strip_seconds:"0:00"}}</td>
			{% if user.is_staff or user.permission.enable_view_temporary_staff_record %}
			<td>
				<a class="btn btn-default" id="name" 
                    href="{% url 'sao:staff_detail' o.employee.employee_no year month %}">詳細</a>
			</td>
			{% endif %}
			<td>
				<a class="btn btn-default" id="name" href="{% url 'sao:web_timestamp_view' o.employee.employee_no %}">⌚</a>
			</td>
		</tr>
		{% endfor %}
	</table>
</div>

{% endblock %} {% block footer %} ■
{% endblock %}